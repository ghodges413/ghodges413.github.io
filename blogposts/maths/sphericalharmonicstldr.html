<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Fourier TLDR</title>
<meta name="keywords" content="Spherical Harmonics, Cubemap Integration Over Sphere" />
<meta name="description" content="A blog of math and code" />
<link href="../../tooplate_style.css" rel="stylesheet" type="text/css" />
<!--   Load MathJax javascript   -->
<!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>
</script>
-->
<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async>
</script>
<!--   Free Website Template by t o o p l a t e . c o m   -->
</head>
<body>

<div id="tooplate_header_wrapper">
	<div id="tooplate_header">

        <div id="tooplate_menu">
            <ul>
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../about.html">About</a></li>
                <li><a href="https://twitter.com/ghodges_dev" title="Follow me on Twitter.">Twitter</a></li>
            </ul>    	
        </div> <!-- end of tooplate_menu -->

<!--
    	<div id="site_title"><h1><a rel="nofollow" href="http://www.tooplate.com">Free Website Templates</a></h1></div>
-->    
        <div id="site_title"><h1>Spherical Harmonics TL;DR</h1></div>
        
    </div> <!-- end of header -->
</div> <!-- end of header wrapper -->
<div id="tooplate_main_wrapper">
    <div id="tooplate_top"></div>
	
    <div id="tooplate_main">
        <div id="tooplate_content_wrapper">
		
        	<div id="tc_top"></div>
			
        	<div id="tooplate_content">
                <div class="post_box">
				
                	<div class="post_header">
                    	<p class="date">
                        	<span>2018/12/22</span>
                        </p>
                        <!--
                            <p class="meta">
                                Posted in <a href="#">Internet</a>, <a href="#">Marketing</a> by <a href="#">Jenave</a>
                            </p>
                        -->
                        <div class="cleaner"></div>
					</div>
                
                    <h2>TL;DR</h2>
                    <p>
                        Spherical Harmonics are the solutions to Laplace's equation ( \( \nabla^2 f = 0 \) ) in spherical coordinates:

                        $$\frac{ \partial^2 f }{ \partial x^2 } + \frac{ \partial^2 f }{ \partial y^2 } + \frac{ \partial^2 f }{ \partial z^2 } = 0$$

                        And the general solution to this equation (known as spherical harmonics) is:

                        $$
                        \Phi( r, \theta, \phi ) = \sum_{ l \geq 0 } \sum_{m=-l}^l (A_{lm} r^l + B_{lm} r^{-l-1} ) Y_l^m( \theta, \phi )
                        $$

                        Where the \( Y_l^m \)'s are known as the associated Legendre's polynomials and are defined as:

                        $$
                        Y_l^m( \theta, \phi ) = \sqrt{ \frac{ (2l+1)(l-m)! }{ 4\pi(l+m)! } } P_l^m( \cos \theta ) e^{ i m \phi }, -l \leq m \leq l
                        $$

                        And the \( P_l^m \)'s are known as Legendre's polynomials and are defined as:

                        $$
                        P_l^m( \cos \theta ) = ( 1 - ( \cos \theta )^2 )^{ \frac{ m }{ 2 } } \frac{ d^m }{ d( \cos \theta )^m } P_l( \cos \theta )
                        $$

                        And the \( P_l \)'s are expressed by Rodrigues's formula:

                        $$
                        P_l( \cos \theta ) = \frac{ 1 }{ 2^n n! } \frac{ d^n }{ d( \cos \theta )^n } ( ( \cos \theta )^2 - 1 )^n
                        $$
                    </p>

                    <h2>Application</h2>
                    <p>
                        This equation is incredibly useful for describing spherical symmetries.  It's found application in electromagnetic theory, where it
                        can be used to describe electric potentials and fields.  It is also useful in quantum theory for describing solutions to the
                        Schrodinger equation for the hydrogen atom.
                    </p>
                    <p>
                        It's used in computer graphics where it can be used to efficiently approximate
                        <a href="https://graphics.stanford.edu/papers/envmap/" title="Irradiance Environment Maps">irradince environment maps</a>.  And this
                        could similarly be applied to lightmaps.
                    </p>
                    <p>
                        They're also useful in audio processing.  Where they can be used to record and reproduce 3D sound fields. 
                    </p>

                    <h2>Derivation</h2>
                    <p>
                        Laplace's equation is stated as
                        $$\nabla^2 f = 0$$
                        and expanded out in three dimensional cartesian coordinates
                        $$\frac{ \partial^2 f }{ \partial x^2 } + \frac{ \partial^2 f }{ \partial y^2 } + \frac{ \partial^2 f }{ \partial z^2 } = 0$$

                        Now, what is the equivalent of this equation in spherical coordinates?  Well, given the fact that spherical coordinates is defined
                        with the relationship that

                        $$x = r \cos( \phi ) \sin( \theta )$$
                        $$y = r \sin( \phi ) \sin( \theta )$$
                        $$z = r \cos( \theta )$$

                        And the chain rule can be simply stated

                        $$ \frac{ \partial }{ \partial t } f( g ( t ) ) = \frac{ \partial f }{ \partial g } \frac{ \partial g }{ \partial t }$$

                        And therefore we can write out the chain rule in matrix form as

                        $$
                        \begin{bmatrix}
                            \frac{ \partial f }{ \partial r }\\
                            \frac{ \partial f }{ \partial \phi }\\
                            \frac{ \partial f }{ \partial \theta }\\
                        \end{bmatrix}
                        = J \cdot
                        \begin{bmatrix}
                            \frac{ \partial f }{ \partial x }\\
                            \frac{ \partial f }{ \partial y }\\
                            \frac{ \partial f }{ \partial z }\\
                        \end{bmatrix}
                        $$
                        
                        Where J is the <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant" title="Jacobian Matrix">Jacobian</a>
                        (a matrix that defines changes between coordinate systems), and is defined as:

                        $$
                        J = 
                        \begin{bmatrix}
                            \frac{ \partial x }{ \partial r } & \frac{ \partial y }{ \partial r } & \frac{ \partial z }{ \partial r }\\
                            \frac{ \partial x }{ \partial \phi } & \frac{ \partial y }{ \partial \phi } & \frac{ \partial z }{ \partial \phi }\\
                            \frac{ \partial x }{ \partial \theta } & \frac{ \partial y }{ \partial \theta } & \frac{ \partial  }{ \partial \theta }\\
                        \end{bmatrix}
                        $$

                        And therefore we can also write
                        $$
                        \begin{bmatrix}
                            \frac{ \partial f }{ \partial x }\\
                            \frac{ \partial f }{ \partial y }\\
                            \frac{ \partial f }{ \partial z }\\
                        \end{bmatrix}
                        = J^{-1} \cdot
                        \begin{bmatrix}
                            \frac{ \partial f }{ \partial r }\\
                            \frac{ \partial f }{ \partial \phi }\\
                            \frac{ \partial f }{ \partial \theta }\\
                        \end{bmatrix}
                        $$

                        Where \( J^{-1} \) is the inverse of the Jacobian.  And if we manually work all this out, then we will end up with:

                        $$
                        \begin{bmatrix}
                            \frac{ \partial f }{ \partial x }\\
                            \frac{ \partial f }{ \partial y }\\
                            \frac{ \partial f }{ \partial z }\\
                        \end{bmatrix}

                        =

                        \begin{bmatrix}
                            \cos( \phi )\sin( \theta ) &  -\frac{ \sin( \phi ) }{ r \sin( \theta ) } & \frac{ \cos( \phi )\cos( \theta ) }{ r }\\
                            \sin( \phi )\sin( \theta ) &  \frac{ \cos( \phi ) }{ r \sin( \theta ) } & \frac{ \sin( \phi )\cos( \theta ) }{ r }\\
                            \cos( \theta ) & 0 & -\frac{ \sin( \theta ) }{ r }
                        \end{bmatrix}

                        \cdot

                        \begin{bmatrix}
                            \frac{ \partial f }{ \partial r }\\
                            \frac{ \partial f }{ \partial \phi }\\
                            \frac{ \partial f }{ \partial \theta }\\
                        \end{bmatrix}
                        $$

                        And if we now plug all this into Laplace's equation, then we obtain the equation in spherical coordinates:

                        $$
                        \nabla^2 f = 
                        \frac{ 1 }{ r^2 } \frac{ \partial }{ \partial r}( r^2 \frac{ \partial f }{ \partial r } ) +
                        \frac{ 1 }{ r^2 \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial f }{ \partial \theta } ) +
                        \frac{ 1 }{ r^2 \sin^2( \theta ) } \frac{ \partial^2 f }{ \partial \phi^2 }
                        = 0
                        $$

                        We can easily see that we can factor out the \( \frac{ 1 }{ r^2 } \), so we'll simply multiply through by \( r^2 \) and get

                        $$
                        \frac{ \partial }{ \partial r}( r^2 \frac{ \partial f }{ \partial r } ) +
                        \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial f }{ \partial \theta } ) +
                        \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 f }{ \partial \phi^2 }
                        = 0
                        $$

                        Now, with a little re-organization, we might be able to enlighten ourselves.  And so with malice of forethought we get:

                        $$
                        -\frac{ \partial }{ \partial r}( r^2 \frac{ \partial f }{ \partial r } ) =
                        \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial f }{ \partial \theta } ) +
                        \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 f }{ \partial \phi^2 }
                        $$

                        This next bit takes a little bit of thought.  So bare with me here.  First, we have to assume that \( f( r, \phi, \theta ) \) is
                        a separable function that can be written as (mathematicians sometimes do hand wavy shit too):

                        $$ f( r, \phi, \theta ) = R( r ) Y( \phi, \theta ) $$

                        This means we can re-write the equation as:

                        $$
                        -\frac{ \partial }{ \partial r}( r^2 \frac{ \partial f }{ \partial r } ) Y =
                        \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial Y }{ \partial \theta } ) R +
                        \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 Y }{ \partial \phi^2 } R
                        $$

                        And moving the Y's to the right hand side and the R's to the left hand side yields:

                        $$
                        \frac{ 1 }{ R } \frac{ \partial }{ \partial r}( r^2 \frac{ \partial f }{ \partial r } ) =
                        -\frac{ 1 }{ Y } \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial Y }{ \partial \theta } )
                        -\frac{ 1 }{ Y } \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 Y }{ \partial \phi^2 }
                        $$
                        
                        Since \( r, \phi, \theta \) are all independent variables,
                        and the left hand side is only dependent on \( r \) and the right hand side is only dependent on \( \phi \), and \( \theta \) then this equation
                        is only correct if the left hand side is equal to a constant and the right hand side also equal to the same constant, implying that:

                        $$
                        \frac{ 1 }{ R } \frac{ \partial }{ \partial r}( r^2 \frac{ \partial R }{ \partial r } ) =
                        -\frac{ 1 }{ Y } \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial Y }{ \partial \theta } )
                        -\frac{ 1 }{ Y } \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 Y }{ \partial \phi^2 } =
                        \lambda
                        $$

                        or

                        $$
                        \frac{ 1 }{ R } \frac{ \partial }{ \partial r}( r^2 \frac{ \partial R }{ \partial r } ) = \lambda,

                        \frac{ 1 }{ Y } \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial Y }{ \partial \theta } )
                        + \frac{ 1 }{ Y } \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 Y }{ \partial \phi^2 } =
                        -\lambda
                        $$

                        Now, once again, if we assume that \( Y( \phi, \theta ) \) can be written such that \( Y( \phi, \theta ) = \Phi( \phi )\Theta( \theta ) ) \),
                        then we can re-write the second equation as:

                        $$
                        \frac{ 1 }{ \Theta } \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial \Theta }{ \partial \theta } )
                        + \frac{ 1 }{ \Phi } \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 \Phi }{ \partial \phi^2 } =
                        -\lambda
                        $$

                        Great, let's see if we can separate this further.  With the power of algebra we can get:

                        $$
                        \frac{ 1 }{ \Phi } \frac{ 1 }{ \sin^2( \theta ) } \frac{ \partial^2 \Phi }{ \partial \phi^2 } =
                        -\frac{ 1 }{ \Theta } \frac{ 1 }{ \sin( \theta ) } \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial \Theta }{ \partial \theta } )
                        -\lambda
                        $$

                        $$
                        \frac{ 1 }{ \Phi } \frac{ \partial^2 \Phi }{ \partial \phi^2 } =
                        -\frac{ 1 }{ \Theta } \sin( \theta ) \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial \Theta }{ \partial \theta } )
                        -\lambda \sin^2( \theta )
                        $$

                        Once again we can use the argument that these two functions are independent and can only be equal to each other if they're both
                        equal to a common constant.  And for historical purposes, I'm going to choose \( -m^2 \) as that constant.  Which gives us the
                        following equations:

                        $$
                        \frac{ 1 }{ R } \frac{ \partial }{ \partial r}( r^2 \frac{ \partial R }{ \partial r } ) = \lambda,
                        $$

                        $$
                        \frac{ 1 }{ \Phi } \frac{ \partial^2 \Phi }{ \partial \phi^2 } = -m^2,
                        $$

                        $$
                        \frac{ 1 }{ \Theta } \sin( \theta ) \frac{ \partial }{ \partial \theta }( \sin( \theta ) \frac{ \partial \Theta }{ \partial \theta } )
                        + \lambda \sin^2( \theta ) = m^2
                        $$

                        So now we have three ordinary differential equations ( ODEs ).

                        Now, I'm going to start with solving the equation for \( \Phi \).  Now, we know from the study of <a href="https://ghodges413.github.io/blogposts/maths/fouriertldr.html">Fourier Series</a>
                        that solution to this equation is:

                        $$
                        \Phi( \phi ) = { \sum_{m=-\infty}^{\infty} { C_m{e}^{ { \pi i \over L} m \phi } } }
                        $$

                        We also know, that since \( \Phi \) is a function around a circle, and in order for it to be smooth and continuous it must have
                        the following boundary conditions:

                        $$
                        \Phi( 0 ) = \Phi( 2\pi ),
                        \frac{ d\Phi }{ d\phi }( 0 ) = \frac{ d\Phi }{ d\phi }( 2\pi )
                        $$

                        And this means that

                        $$
                        \Phi( \phi ) = { e }^{ \pm i m \phi }
                        $$

                        And \( m \) must be an integer.

                        $$$$                        

                        Now, let's focus our attention 


                        So now we can see how these turn into ordinary differential equations (ODEs).  And this means we can now leverage all the work that any
                        student of differential equations has already performed.  Let's start with \( R( r ) \), that seems like a simple one:

                        $$
                        \frac{ 1 }{ R } \frac{ \partial }{ \partial r}( r^2 \frac{ \partial R }{ \partial r } ) = \lambda \\
                        => \frac{ \partial^2 R }{ \partial r^2 } + 2 r \frac{ \partial R }{ \partial r } - \lambda R = 0
                        $$

                        And we know from ordinary differential equations (ODEs) that the solution to this equation is:

                    </p>
                    

                    <div class="cleaner"></div>
                    
                    
                    


                    <h2>Recommended Reading</h2>
                    <p>Fourier Series (Dover Books on Mathematics) by Georgi P. Tolstov (ISBN-13: 978-0486633176)</p>
                    <p></p>
                    <a href="http://www.dspguide.com/pdfbook.htm">Free online DSP book</a>
                    <p></p>
                    <a href="https://www.youtube.com/watch?v=hVOA8VtKLgk&list=PLuh62Q4Sv7BUSzx5Jr8Wrxxn-U10qG1et">DSP video lectures</a>
                    <div class="cleaner"></div>
                    
                </div>
            </div>
            <div id="tc_bottom"></div>
        </div> <!-- end of content wrapper -->
        <!--
        <div id="tooplate_sidebar_wrapper">
            <div id="tooplate_sidebar_top"></div>
			
            <div id="tooplate_sidebar">
                <div class="ads_250x250">
                    <a href="#"><img src="../../images/Fourier_transform_time_and_frequency_domains_(small).gif" alt="Fourier Transform by Lucas Barbosa" style="width:250px;height:250px;"></a>
                </div>                
                <div class="sb_box">
                    <h3>Categories</h3>
                    <ul class="tooplate_list">
                        <li><a href="#">TODO: Fill me out</a></li>
                    </ul>
                </div>
                <div class="cleaner"></div>
            </div>
			
            <div id="tooplate_sidebar_bottom"></div>
        </div> --> <!-- end of sidebar wrapper -->
        
        <div class="cleaner"></div>
    </div>
    
    <div id="tooplate_bottom"></div>
</div> <!-- end of main wrapper -->

<div id="tooplate_footer">

    <a href="#">Fine!  I'll have a footer.  Everyone else does!</a>

</div>

</body>
</html>